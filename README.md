# 抢票工具 v1.0

一个精确的时间点击工具，支持毫秒级精度，适用于各种需要精确时间点击的场景。

## ✨ 主要功能

- 🎯 **精确点击**: 毫秒级时间精度控制
- 🌐 **网络时间同步**: 从多个NTP服务器获取准确时间
- ⏰ **24小时制时间设置**: 支持精确到秒的时间设置
- 📊 **实时倒计时**: 显示到目标时间的精确倒计时
- 📝 **详细日志**: 记录点击执行时间和耗时
- 🖱️ **鼠标位置设置**: 可视化设置点击位置
- 💻 **跨平台支持**: Windows 和 macOS 都可运行

## 🚀 快速开始

### 方法一：直接运行Python脚本 (推荐用于开发)

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行程序**
   ```bash
   python ticket_grabber.py
   ```

### 方法二：Windows .exe 文件

1. **构建exe文件**
   ```bash
   python build_exe.py
   ```
   或者在Windows上双击运行 `build_windows.bat`

2. **运行程序**
   构建完成后，在 `dist` 目录中找到 `抢票工具.exe` 并运行

## 📖 使用指南

### 基本步骤

1. **设置目标时间**
   - 在时间输入框中输入24小时制时间
   - 格式：HH:MM:SS (例如：14:00:00)

2. **同步网络时间**
   - 点击"同步网络时间"按钮
   - 确保获得最准确的时间基准

3. **设置鼠标位置**
   - 点击"设置鼠标位置"按钮
   - 在3秒倒计时内将鼠标移至目标位置

4. **启动抢票**
   - 点击"启动"按钮开始等待
   - 程序将在指定时间自动点击

5. **查看结果**
   - 在日志区域查看点击执行的详细信息
   - 包括执行时间和点击耗时

### 界面说明

```
┌─────────────────────────────────┐
│ 目标时间: [14:00:00] [启动]      │
│                                 │
│ 当前时间: 14:30:25.123          │
│ 倒计时:   00:05:30.877          │
│ 状态:     等待中...             │
│ 鼠标位置: (1024, 768)           │
│                                 │
│ [同步网络时间] ✓已同步           │
│ [设置鼠标位置]                   │
│                                 │
│ ─────────────────────────────── │
│ 点击日志:                       │
│ [14:35:56.001] 点击执行 (2ms)   │
│ [14:35:56.003] 点击完成         │
└─────────────────────────────────┘
```

## ⚙️ 高级功能

### 网络时间同步

程序支持多种时间同步方式：

1. **NTP协议**: 从 `time.nist.gov`, `pool.ntp.org` 等服务器获取
2. **HTTP API**: 备用方案，使用 `worldtimeapi.org`
3. **自动偏差校正**: 计算并补偿本地时间偏差

### 精度优化

- 使用多线程避免界面阻塞
- 1毫秒检查间隔确保精确触发
- `time.perf_counter()` 提供高精度计时

### 安全特性

- **紧急停止**: 将鼠标移至屏幕左上角可立即停止
- **输入验证**: 严格的时间格式检查
- **错误处理**: 完善的异常捕获和提示

## 🔧 技术参数

- **时间精度**: 毫秒级 (±1ms)
- **网络延迟补偿**: 自动计算和校正
- **支持系统**: Windows 7+, macOS 10.12+
- **Python版本**: 3.7+

## 📋 依赖包

```
pyautogui==0.9.54    # 鼠标自动化
requests==2.31.0     # HTTP请求
pyinstaller==6.3.0   # 打包工具
```

## ⚠️ 注意事项

1. **网络连接**: 确保稳定的网络连接以获得准确时间
2. **屏幕分辨率**: 支持任意分辨率，但需要正确设置鼠标位置
3. **系统权限**: 可能需要允许程序控制鼠标的权限
4. **时区设置**: 程序使用本地时区，请确保系统时区设置正确

## 🐛 故障排除

### 常见问题

**Q: 程序无法启动**
A: 检查Python环境和依赖包是否正确安装

**Q: 点击位置不准确**
A: 重新设置鼠标位置，确保在目标位置停留足够时间

**Q: 时间同步失败**
A: 检查网络连接，或尝试手动运行时间同步

**Q: 点击没有执行**
A: 确认目标时间格式正确，且已设置鼠标位置

### 调试模式

在日志区域可以看到详细的执行信息：
- 时间同步状态和偏差
- 鼠标位置设置结果
- 点击执行时间和耗时
- 错误信息和异常详情

## 📜 许可证

本项目仅用于学习和研究目的。请遵守相关网站的使用条款，理性使用自动化工具。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个工具！

---

**版本**: v1.0  
**更新时间**: 2024年  
**兼容性**: Windows & macOS